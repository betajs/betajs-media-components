
<div data-selector="recorder-container" ba-show="{{!player_active}}"
     class="{{css}}-container {{css}}-size-{{csssize}} {{iecss}}-{{ie8 ? 'ie8' : 'noie8'}} {{csstheme}}
     	{{css}}-{{ fullscreened ? 'fullscreen' : 'normal' }}-view {{css}}-{{ firefox ? 'firefox' : 'common'}}-browser
    	{{css}}-{{themecolor}}-color"
     style="{{width ? 'width:' + width + ((width + '').match(/^\d+$/g) ? 'px' : '') + ';' : 'width:100%;'}}{{height ? 'height:' + height + ((height + '').match(/^\d+$/g) ? 'px' : '') + ';' : 'height:100%'}}"
>

    <video data-selector="recorder-status" class="{{css}}-video {{css}}-{{hasrecorder ? 'hasrecorder' : 'norecorder'}}" data-video="video"></video>
	<ba-recorderfaceoutline class="{{css}}-overlay" ba-if="{{faceoutline && hasrecorder}}">
	</ba-recorderfaceoutline>
    <div data-selector="recorder-overlay" class='{{css}}-overlay' ba-show="{{!hideoverlay}}" data-overlay="overlay">
		<ba-{{dynloader}}
		    ba-css="{{cssloader || css}}"
			ba-themecolor="{{themecolor}}"
		    ba-template="{{tmplloader}}"
		    ba-show="{{loader_active}}"
		    ba-tooltip="{{loadertooltip}}"
			ba-hovermessage="{{=hovermessage}}"
		    ba-label="{{loaderlabel}}"
		></ba-{{dynloader}}>

		<ba-{{dynmessage}}
		    ba-css="{{cssmessage || css}}"
			ba-themecolor="{{themecolor}}"
		    ba-template="{{tmplmessage}}"
		    ba-show="{{message_active}}"
		    ba-message="{{message}}"
		    ba-event:click="message_click"
		></ba-{{dynmessage}}>

		<ba-{{dyntopmessage}}
		    ba-css="{{csstopmessage || css}}"
			ba-themecolor="{{themecolor}}"
		    ba-template="{{tmpltopmessage}}"
		    ba-show="{{topmessage_active && (topmessage || hovermessage)}}"
		    ba-topmessage="{{hovermessage || topmessage}}"
		></ba-{{dyntopmessage}}>

		<ba-{{dynchooser}}
			ba-onlyaudio="{{onlyaudio}}"
		    ba-css="{{csschooser || css}}"
			ba-themecolor="{{themecolor}}"
		    ba-template="{{tmplchooser}}"
			ba-screen="{{screen}}"
		    ba-if="{{chooser_active && !is_initial_state}}"
		    ba-allowrecord="{{allowrecord}}"
		    ba-allowupload="{{allowupload}}"
		    ba-allowcustomupload="{{allowcustomupload}}"
		    ba-allowedextensions="{{allowedextensions}}"
		    ba-primaryrecord="{{primaryrecord}}"
		    ba-timelimit="{{timelimit}}"
		    ba-event:record="record_video"
		    ba-event:upload="upload_video"
		></ba-{{dynchooser}}>

		<ba-{{dynimagegallery}}
		    ba-css="{{cssimagegallery || css}}"
			ba-themecolor="{{themecolor}}"
		    ba-template="{{tmplimagegallery}}"
		    ba-if="{{imagegallery_active}}"
		    ba-imagecount="{{gallerysnapshots}}"
		    ba-imagenativewidth="{{recordingwidth}}"
		    ba-imagenativeheight="{{recordingheight}}"
		    ba-event:image-selected="select_image"
		></ba-{{dynimagegallery}}>

		<ba-{{dyncontrolbar}}
		    ba-css="{{csscontrolbar || css}}"
			ba-themecolor="{{themecolor}}"
		    ba-template="{{tmplcontrolbar}}"
		    ba-show="{{controlbar_active}}"
		    ba-cameras="{{cameras}}"
		    ba-microphones="{{microphones}}"
		    ba-noaudio="{{noaudio}}"
			ba-novideo="{{onlyaudio}}"
			ba-screen="{{screen}}"
		    ba-selectedcamera="{{selectedcamera || 0}}"
		    ba-selectedmicrophone="{{selectedmicrophone || 0}}"
		    ba-camerahealthy="{{camerahealthy}}"
		    ba-microphonehealthy="{{microphonehealthy}}"
		    ba-hovermessage="{{=hovermessage}}"
		    ba-settingsvisible="{{settingsvisible}}"
		    ba-recordvisible="{{recordvisible}}"
			ba-cancelvisible="{{allowcancel && cancancel}}"
		    ba-uploadcovershotvisible="{{uploadcovershotvisible}}"
		    ba-rerecordvisible="{{rerecordvisible}}"
		    ba-stopvisible="{{stopvisible}}"
		    ba-skipvisible="{{skipvisible}}"
		    ba-controlbarlabel="{{controlbarlabel}}"
			ba-mintimeindicator="{{mintimeindicator}}"
			ba-timeminlimit="{{timeminlimit}}"
		    ba-event:select-camera="select_camera"
		    ba-event:select-microphone="select_microphone"
		    ba-event:invoke-record="record"
		    ba-event:invoke-rerecord="rerecord"
		    ba-event:invoke-stop="stop"
		    ba-event:invoke-skip="invoke_skip"
		    ba-event:upload-covershot="upload_covershot"
		></ba-{{dyncontrolbar}}>
    </div>
</div>

<div data-selector="recorder-player" ba-if="{{player_active}}"
     style="{{width ? 'width:' + width + ((width + '').match(/^\d+$/g) ? 'px' : '') + ';' : ''}}{{height ? 'height:' + height + ((height + '').match(/^\d+$/g) ? 'px' : '') + ';' : ''}}"
>
	<span ba-show="{{ie8}}">&nbsp;</span>
	<ba-{{dynvideoplayer}}
	    ba-theme="{{theme || 'default'}}"
        ba-themecolor="{{themecolor}}"
        ba-source="{{playbacksource}}"
        ba-poster="{{playbackposter}}"
        ba-hideoninactivity="{{false}}"
        ba-forceflash="{{forceflash}}"
        ba-noflash="{{noflash}}"
        ba-stretch="{{stretch}}"
		ba-onlyaudio="{{onlyaudio}}"
        ba-attrs="{{playerattrs}}"
        ba-data:id="player"
        ba-width="{{width}}"
        ba-height="{{height}}"
        ba-totalduration="{{duration / 1000}}"
        ba-rerecordable="{{rerecordable && (recordings === null || recordings > 0)}}"
        ba-submittable="{{manualsubmit && verified}}"
        ba-reloadonplay="{{true}}"
        ba-autoplay="{{autoplay}}"
        ba-nofullscreen="{{nofullscreen}}"
        ba-topmessage="{{playertopmessage}}"
		ba-event:loaded="ready_to_play"
        ba-event:rerecord="rerecord"
        ba-event:playing="playing"
        ba-event:paused="paused"
        ba-event:ended="ended"
        ba-event:submit="manual_submit"
	>
	</ba-{{dynvideoplayer}}>
</div>
